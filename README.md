## FORMA — премиальный сайт + лёгкая PHP‑CMS

Минималистичный премиум‑сайт студии с динамическим контентом и админ‑панелью. Проект разворачивается на любом обычном хостинге (PHP + MySQL) через install.php.

### Ключевые возможности
- **Страницы**: CRUD, HTML‑контент, SEO‑поля (title/description), статус публикации
- **Блог**: список записей и детальные страницы (CRUD) в админке
- **WYSIWYG**: встроен TinyMCE (линки, списки, таблицы, изображение, код)
- **Медиа‑менеджер**: загрузка файлов в `uploads/`, предпросмотр и копирование URL
- **Навигация и шаблоны**: минималистичный премиум‑UI, общий хедер/футер
- **Sitemap**: динамический `/sitemap.xml` из БД; `robots.txt` в корне
- **Настройки**: `site_name`, `base_url` в панели, хранятся в таблице `settings`
- **Роли и аудит**: роли `admin|editor` (база) и журнал действий `audit_log` (создание/редактирование страниц и постов)
- **Установщик**: `install.php` создаёт `includes/config.php`, схему БД и заливает стартовые страницы
- **SEO/скорость**: чистая вёрстка, адаптив, современный стеклянный хедер, лёгкие скрипты

### Требования
- **PHP** 8.1+ с расширением pdo_mysql
- **MySQL/MariaDB** 5.7/8.0+
- **Веб‑сервер**: Apache с mod_rewrite (в комплекте `.htaccess`) или Nginx (пример ниже)

### Структура
```
forma-site/
  .htaccess                # ЧПУ для Apache
  .gitignore
  install.php              # Установщик (запустить в браузере)
  index.php                # Фронт‑контроллер (роутинг)
  assets/                  # CSS/JS
  uploads/                 # Загруженные файлы (пишется на диск)
  includes/                # Конфиг, DB, хелперы, SQL‑схема
    config.sample.php
    config.php             # создаётся установщиком (в .gitignore)
    db.php, auth.php, helpers.php, schema.sql
  admin/                   # Админ‑панель
    login.php, index.php, media.php, page_edit.php, post_edit.php, settings.php
  templates/               # Шаблоны блога
  index.html ...           # Исходные статические страницы (импортируются в БД при установке)
  robots.txt, sitemap.xml  # статические заготовки (sitemap также доступен динамически)
```

### Установка на хостинге (Apache)
1. Создайте пустую БД MySQL и пользователя с правами.
2. Загрузите содержимое папки проекта в корень сайта.
3. Убедитесь, что включён **mod_rewrite** и `.htaccess` разрешён.
4. Дайте права на запись каталогу `uploads/` (и при необходимости `includes/` для создания `config.php`):
```bash
chmod -R 775 uploads
```
5. Откройте в браузере `https://ваш-домен/install.php` и пройдите установку.
6. Войдите в админку: `https://ваш-домен/admin/login.php`.
7. (Опционально) Удалите `install.php` после установки.

### Быстрый запуск локально (встроенный сервер PHP)
```bash
cd /path/to/forma-site
php -S localhost:8000 -t .
# откройте http://localhost:8000
```
Встроенный сервер корректно отдаёт `index.php` для несуществующих файлов, поэтому ЧПУ работают без `.htaccess`.

### Nginx (пример конфига)
```
location / {
  try_files $uri $uri/ /index.php?$args;
}
location ~ \.php$ {
  include fastcgi_params;
  fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
  fastcgi_pass unix:/run/php/php8.2-fpm.sock;
}
```

### Админ‑панель: функции
- **Страницы**: заголовок, слаг (`/` для главной), HTML‑контент, SEO‑поля, публикация
- **Посты**: блоговые записи со слагом `/blog/{slug}`
- **Медиа**: загрузка файлов и копирование ссылок для вставки в контент
- **Настройки**: `site_name`, `base_url` (используется для формирования абсолютных ссылок)
- **Аудит**: создаётся запись при `create/update` страниц/постов (таблица `audit_log`)

### Маршрутизация
- Главная страница: запись `pages` со `slug=''`
- Любая страница: `/about`, `/pricing`, ... — берётся из `pages.slug`
- Блог: `/blog` и `/blog/{slug}` — таблица `posts`
- Sitemap: `/sitemap.xml` — генерируется из опубликованных `pages` и `posts`

### Настройка домена (base_url)
В админке на странице «Настройки» укажите `base_url` вида `https://example.com` — это позволит корректно подставлять абсолютные пути в контенте.

### Git / деплой на GitHub
```bash
# в папке проекта
git init
git add .
git commit -m "Initial commit"
git remote add origin https://github.com/USER/REPO
# если на удалённом уже есть коммиты
git pull origin main --allow-unrelated-histories
git push -u origin main
```

### Безопасность
- Сразу смените пароль администратора после установки
- Храните `includes/config.php` вне репозитория (уже в `.gitignore`)
- Ограничьте доступ к `install.php` или удалите его после установки
- Держите `uploads/` с корректными правами (не 777)

### Roadmap (можно расширить)
- Предпросмотр черновиков по токену
- Редактор меню (drag&drop) с сохранением в БД
- Роли и права: ограничение возможностей для `editor`
- Версионность контента и откат
- Генерация статического кеша страниц для высокой нагрузки

### Поддержка
Вопросы и улучшения приветствуются в Issues репозитория.
